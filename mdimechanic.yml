code_name: 'polariton-example'
docker:
  image_name: 'mdiengine'

  build_image:
    - apt-get update
    - apt-get install -y build-essential cmake clang libssl-dev
    - apt-get install -y libopenblas-base libopenblas-dev
    - apt-get install -y libmpfr-dev libeigen3-dev
    - pip install numpy pymdi pydantic Pint scipy
    #- pip install pymdi
    #- pip install pydantic
    #- pip install Pint
    #- pip install scipy

    # Build Psi4
    - git clone https://github.com/psi4/psi4.git /psi4
    - cd /psi4
    - cmake -S. -Bobjdir -DCMAKE_BUILD_TYPE=Release -DENABLE_XHOST=OFF -DBUILD_SHARED_LIBS=ON
    - cd objdir
    - make -j 8 VERBOSE=1

    # Install Psi4 as a Python package
    - make install
    - cd /
    - rm -rf /psi4
    - mkdir /psi4_scratch
    - echo "export PYTHONPATH=\$PYTHONPATH:/usr/local/psi4/lib" >> ~/.profile
    - echo "export PYTHONPATH=\$PYTHONPATH:/usr/local/psi4/lib" >> ~/.bashrc
    - echo "export PATH=\$PATH:/usr/local/psi4/bin" >> ~/.profile
    - echo "export PATH=\$PATH:/usr/local/psi4/bin" >> ~/.bashrc
    - echo "export PSI_SCRATCH=/psi4_scratch" >> ~/.profile
    - echo "export PSI_SCRATCH=/psi4_scratch" >> ~/.bashrc

  build_engine:
    - echo "Insert commands to build your engine code here"

  validate_engine:
    - echo "Insert code that will confirm that your code has been built successfully"
    - exit 1

engine_tests:
  # Provide at least one example input that can be used to test your code's MDI functionality
  script:
    - echo "Insert commands to run an example calculation here"
    - exit 1
